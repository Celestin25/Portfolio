<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="admin.css" />
  </head>
  <body>
    <header class="header">
      <a href="index.html" class="logo">Celestin</a>
      <nav class="navbar">
        <a href="index.html">Home</a>
      </nav>
    </header>

    <div class="admin-panel">
      <nav class="admin-nav">
        <ul>
          <li><a href="#dashboard">Dashboard</a></li>
          <li><a href="#manage-posts" class="active">Manage Posts</a></li>
          <li><a href="#settings">Settings</a></li>
        </ul>
      </nav>
      <div class="content">
        <h1>Manage Blog Posts</h1>
        <div class="posts-list"></div>
        <div class="post-form">
          <h2>Create/Edit Post</h2>
          <input type="text" placeholder="Title" id="post-title" />
          <textarea placeholder="Content" id="post-content"></textarea>
          <input type="text" placeholder="Image URL" id="post-image" />
          <button id="save-post-btn" data-editing="false">Save Post</button>
        </div>
      </div>
    </div>
    <script>
      let blogPosts = JSON.parse(localStorage.getItem("blogPosts")) || [];
      let editingPostId = null;

      function savePosts() {
        localStorage.setItem("blogPosts", JSON.stringify(blogPosts));
        displayPosts();
      }

      function addOrEditPost() {
        const title = document.getElementById("post-title").value.trim();
        const content = document.getElementById("post-content").value.trim();
        const imageUrl = document.getElementById("post-image").value.trim();

        if (title === "" || content === "") {
          alert("Both title and content are required.");
          return;
        }

        const postData = { title, content, imageUrl };
        if (editingPostId) {
          const postIndex = blogPosts.findIndex(
            (post) => post.id === editingPostId
          );
          if (postIndex !== -1) {
            blogPosts[postIndex] = { ...blogPosts[postIndex], ...postData };
          }
        } else {
          const newPost = { id: Date.now(), ...postData };
          blogPosts.push(newPost);
        }

        savePosts();
        clearForm();
      }

      function deletePost(id) {
        blogPosts = blogPosts.filter((post) => post.id !== id);
        savePosts();
      }

      function editPost(id) {
        const post = blogPosts.find((post) => post.id === id);
        if (post) {
          document.getElementById("post-title").value = post.title;
          document.getElementById("post-content").value = post.content;
          document.getElementById("post-image").value = post.imageUrl || "";
          editingPostId = id;
          document.getElementById("save-post-btn").innerText = "Edit Post";
        }
      }

      function clearForm() {
        document.getElementById("post-title").value = "";
        document.getElementById("post-content").value = "";
        document.getElementById("post-image").value = "";
        editingPostId = null;
        document.getElementById("save-post-btn").innerText = "Save Post";
      }

      function displayPosts() {
        const postsList = document.querySelector(".posts-list");
        postsList.innerHTML = "";
        blogPosts.forEach((post) => {
          const postElem = document.createElement("div");
          postElem.innerHTML = `
            <h3>${post.title}</h3>
            ${
              post.imageUrl
                ? `<img src="${post.imageUrl}" alt="Post Image" style="max-width: 100%; height: auto;">`
                : ""
            }
            <p>${post.content}</p>
            <button onclick="editPost(${post.id})">Edit</button>
            <button onclick="deletePost(${post.id})">Delete</button>
          `;
          postsList.appendChild(postElem);
        });
      }

      document
        .getElementById("save-post-btn")
        .addEventListener("click", addOrEditPost);
      document.addEventListener("DOMContentLoaded", displayPosts);
    </script>
  </body>
</html>
